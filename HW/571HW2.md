# Code Smell Topic: Message Chains

## a) ความหมายของ code smell นั้นๆ

- เกิดเมื่อ client request object โดยที่ object ที่ถูก request นั้นได้ไป request object อื่นและเป็นแบบนี้ไปเรื่อยๆ

------------------------------
## b) ตัวอย่างโค้ดที่เกิด code smell

public class Student {

    public StudyClass StudyClass { get; set; }
}

public class StudyClass {

    public Department Department { get; set; }
}

public class Department {

    public Faculty Faculty { get; set; }
}

public class Faculty {

    public string DeanName { get; set; } = "Dr. Smith";
}

var deanName = student.StudyClass.Department.Faculty.DeanName;

------------------------------
## c) ตัวอย่างโค้ดที่ refactoring แล้ว

ใช้การ Hide Delegate โดยให้แต่ละ class ดึงข้อมูลจากใน class ของตัวเองและส่งต่อให้ client ซึ่งเราทำโดยสร้าง method ใน class ต่างๆเพื่อดึงเอาข้อมูลจาก class อื่นและส่งข้อมูลกลับมาให้ class Student

public class Student {

    private StudyClass _studyClass;
    public string GetDeanName() {
        return _studyClass.GetDeanName();
}
    
}

public class StudyClass {

    private Department _department;
    public string GetDeanName() {
        return _department.GetDeanName();
    }
}

public class Department {

    private Faculty _faculty;
    public string GetDeanName() {
        return _faculty.DeanName;
    }
}

public class Faculty {

    public string DeanName { get; set; } = "Dr. Smith";
    
}

string deanName = student.GetDeanName();

------------------------------
## d) กรณีที่ code smell นี้ไม่ได้บ่งบอกถึงโค้ดที่มีปัญหา (กรณีที่ไม่จำเป็นต้อง refactoring)

การใช้งาน LINQ (Language Integrated Query)
-      var topStudents = students
            .Where(s => s.Score > 80)      
            .OrderByDescending(s => s.Score) 
            .Select(s => s.Name)           
            .ToList();
        เพราะเป็นการทำงานกับ var ตัวเดียว
การใช้ String Manipulation
-         string cleanName = inputName.Trim().ToLower().Replace(" ", "_");
        เพราะว่าไม่ได้เป็นการเข้าไปดึง object/ข้อมูล จากหลาย class แต่เป็นการทำกับ var ตัวเดียวและเป็น data type เดิมทำให้ไม่จำเป็นต้อง refactoring
Fluent Builders (เช่นการตั้งค่า Library)
-        services.AddAuthentication()
            .AddJwtBearer()
            .AddCookie();
         เพราะเป็นการทำตาม Design Pattern เพื่อให้สะดวกต่อการตั้งค่า
